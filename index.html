<!-- the "host" page, showing a generator in an iframe -->
<!DOCTYPE html>
<html>
  <head>
    <style>
      iframe {
        width: 100%;
        height: 80vh;
        border: 2px dashed brown;
      }
    </style>
    <script>
      const exporters = [];

      function registerExport(exporter) {
        createExporter(exporter);
        exporters.push(exporter);
      }

      function createExporter(exporter) {
        const button = document.createElement('button');
        button.textContent = `Export ${exporter.mime}, res: ${exporter.resolution.x}x${exporter.resolution.y}`;
        document.body.appendChild(button);

        button.onclick = async () => {
          const link = document.createElement('a');
          link.download = `image.${exporter.mime.split('/')[1]}`;

          exporter.fn(exporter).then((dataURL) => {
            link.href = dataURL;
            link.click();
          });
        };
      }
    </script>
  </head>
  <body>
    <p>Here's a sample generator in an iframe:</p>
    <iframe id="generator" src="./generator.html"></iframe>
    <p>Here are the exporters it registered:</p>
  </body>
</html>
